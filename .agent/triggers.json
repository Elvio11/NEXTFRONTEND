{
    "triggers": {
        "agent_3_resume_intelligence": {
            "type": "http_post",
            "source": "server_1",
            "target": "server_2 /api/agents/resume-intelligence",
            "when": "User uploads resume (onboarding Step 2 or re-upload)",
            "payload": [
                "user_id",
                "file_path",
                "file_type"
            ]
        },
        "agent_4_skill_gap": {
            "type": "crewai_and_parallel",
            "source": "server_2 (after Agent 3 completes)",
            "target": "server_2 internal",
            "when": "Onboarding: after Agent 3 completes. Refresh: every 7 days or new resume.",
            "payload": [
                "user_id"
            ]
        },
        "agent_5_career_intelligence": {
            "type": "crewai_and_parallel",
            "source": "server_2 (after Agent 3 completes)",
            "target": "server_2 internal",
            "when": "Onboarding: after Agent 3 completes. Refresh: every 7 days.",
            "payload": [
                "user_id"
            ]
        },
        "agent_6_fit_scoring_full_scan": {
            "type": "crewai_and_parallel",
            "source": "server_2 (after Agent 3 completes)",
            "target": "server_2 internal",
            "when": "fit_scores_stale = TRUE (new signup, new resume, role change)",
            "payload": [
                "user_id",
                "mode: full_scan"
            ]
        },
        "agent_6_fit_scoring_delta": {
            "type": "http_post",
            "source": "server_2 (after Agent 7 completes)",
            "target": "server_2 /api/agents/fit-score",
            "when": "scrape_runs.scoring_complete = FALSE (after every nightly scrape + JD clean)",
            "payload": [
                "scrape_run_id",
                "mode: delta"
            ]
        },
        "agent_7_jd_cleaning": {
            "type": "http_post",
            "source": "server_3 (after Agent 9 completes)",
            "target": "server_2 /api/agents/jd-clean",
            "when": "New scrape_runs row with has_new_jobs = TRUE",
            "payload": [
                "scrape_run_id"
            ]
        },
        "agent_8_daily_coach": {
            "type": "pg_cron_http",
            "schedule": "0 1 * * *",
            "schedule_ist": "7:00 AM IST daily",
            "target": "server_2 /api/agents/coach",
            "when": "Daily. Paid users with wa_opted_in = TRUE only.",
            "payload": []
        },
        "agent_9_job_scraper": {
            "type": "pg_cron_http",
            "schedule": "30 14 * * *",
            "schedule_ist": "8:00 PM IST daily",
            "target": "server_3 /api/agents/scrape",
            "when": "Daily at 8 PM IST",
            "payload": []
        },
        "agent_10_resume_tailoring": {
            "type": "http_post",
            "source": "server_3 (Agent 12 pre-apply)",
            "target": "server_2 /api/agents/tailor",
            "when": "Tier 1 job, paid user, fit_score >= 75, before apply slot",
            "payload": [
                "user_id",
                "app_id",
                "job_id"
            ]
        },
        "agent_11_cover_letter": {
            "type": "http_post",
            "source": "server_3 (Agent 12 pre-apply) OR server_1 (user dashboard request)",
            "target": "server_2 /api/agents/cover-letter",
            "when": "Alongside Agent 10 for Tier 1. On-demand for Tier 2.",
            "payload": [
                "user_id",
                "app_id",
                "job_id"
            ]
        },
        "agent_12_auto_apply": {
            "type": "internal_queue",
            "source": "server_3 internal scheduler",
            "target": "server_3 internal",
            "when": "User's nightly slot within 8 PM to 6 AM IST window. Slot = hash(user_id + date).",
            "payload": [
                "user_id",
                "slot_time"
            ]
        },
        "agent_13_form_qa": {
            "type": "inline_call",
            "source": "server_3 (Agent 12 — called inline during Selenium)",
            "target": "server_3 internal function",
            "when": "Custom question field detected on apply form",
            "payload": [
                "question_text",
                "user_id",
                "job_id"
            ]
        },
        "agent_14_follow_up_email": {
            "type": "scheduled_poll",
            "schedule": "Hourly",
            "target": "server_3 /api/agents/followup-email",
            "when": "Hourly Gmail scan. Day 7/14/21 email sends only between 9 AM and 11 AM IST.",
            "payload": []
        },
        "agent_14_linkedin_outreach": {
            "type": "scheduled_window",
            "window": "9 AM to 6 PM IST",
            "target": "server_3 /api/agents/linkedin-outreach",
            "when": "2 days after application submitted. Only within operating window.",
            "payload": []
        },
        "agent_15_calibration_layer2": {
            "type": "pg_cron_http",
            "schedule": "30 23 * * *",
            "schedule_ist": "5:00 AM IST daily",
            "target": "server_3 /api/agents/calibrate/daily",
            "payload": []
        },
        "agent_15_calibration_layer3": {
            "type": "pg_cron_http",
            "schedule": "45 18 * * 6",
            "schedule_ist": "12:15 AM IST Sunday",
            "target": "server_3 /api/agents/calibrate/weekly",
            "when": "Requires >= 50 outcome signals in past 7 days. Skip if fewer.",
            "payload": []
        }
    }
}
{
    "triggers": {
        "agent_3_resume_intelligence": {
            "type": "http_post",
            "source": "server_1",
            "target": "server_2 /api/agents/resume-intelligence",
            "when": "User uploads resume (onboarding Step 2 or re-upload)",
            "payload": [
                "user_id",
                "file_path",
                "file_type"
            ]
        },
        "agent_4_skill_gap": {
            "type": "crewai_and_parallel",
            "source": "server_2 (after Agent 3 completes)",
            "target": "server_2 internal",
            "when": "Onboarding: after Agent 3 completes. Refresh: every 7 days or new resume.",
            "payload": [
                "user_id"
            ]
        },
        "agent_5_career_intelligence": {
            "type": "crewai_and_parallel",
            "source": "server_2 (after Agent 3 completes)",
            "target": "server_2 internal",
            "when": "Onboarding: after Agent 3 completes. Refresh: every 7 days.",
            "payload": [
                "user_id"
            ]
        },
        "agent_6_fit_scoring_full_scan": {
            "type": "crewai_and_parallel",
            "source": "server_2 (after Agent 3 completes)",
            "target": "server_2 internal",
            "when": "fit_scores_stale = TRUE (new signup, new resume, role change)",
            "payload": [
                "user_id",
                "mode: full_scan"
            ]
        },
        "agent_6_fit_scoring_delta": {
            "type": "http_post",
            "source": "server_2 (after Agent 7 completes)",
            "target": "server_2 /api/agents/fit-score",
            "when": "scrape_runs.scoring_complete = FALSE (after every nightly scrape + JD clean)",
            "payload": [
                "scrape_run_id",
                "mode: delta"
            ]
        },
        "agent_7_jd_cleaning": {
            "type": "http_post",
            "source": "server_3 (after Agent 9 completes)",
            "target": "server_2 /api/agents/jd-clean",
            "when": "New scrape_runs row with has_new_jobs = TRUE",
            "payload": [
                "scrape_run_id"
            ]
        },
        "agent_8_daily_coach": {
            "type": "pg_cron_http",
            "schedule": "0 1 * * *",
            "schedule_ist": "7:00 AM IST daily",
            "target": "server_2 /api/agents/coach",
            "when": "Daily. Paid users with wa_opted_in = TRUE only.",
            "payload": []
        },
        "agent_9_job_scraper": {
            "type": "pg_cron_http",
            "schedule": "30 14 * * *",
            "schedule_ist": "8:00 PM IST daily",
            "target": "server_3 /api/agents/scrape",
            "when": "Daily at 8 PM IST",
            "payload": []
        },
        "agent_10_resume_tailoring": {
            "type": "http_post",
            "source": "server_3 (Agent 12 pre-apply)",
            "target": "server_2 /api/agents/tailor",
            "when": "Tier 1 job, paid user, fit_score >= 75, before apply slot",
            "payload": [
                "user_id",
                "app_id",
                "job_id"
            ]
        },
        "agent_11_cover_letter": {
            "type": "http_post",
            "source": "server_3 (Agent 12 pre-apply) OR server_1 (user dashboard request)",
            "target": "server_2 /api/agents/cover-letter",
            "when": "Alongside Agent 10 for Tier 1. On-demand for Tier 2.",
            "payload": [
                "user_id",
                "app_id",
                "job_id"
            ]
        },
        "agent_12_auto_apply": {
            "type": "internal_queue",
            "source": "server_3 internal scheduler",
            "target": "server_3 internal",
            "when": "User's nightly slot within 8 PM to 6 AM IST window. Slot = hash(user_id + date).",
            "payload": [
                "user_id",
                "slot_time"
            ]
        },
        "agent_13_form_qa": {
            "type": "inline_call",
            "source": "server_3 (Agent 12 — called inline during Selenium)",
            "target": "server_3 internal function",
            "when": "Custom question field detected on apply form",
            "payload": [
                "question_text",
                "user_id",
                "job_id"
            ]
        },
        "agent_14_follow_up_email": {
            "type": "scheduled_poll",
            "schedule": "Hourly",
            "target": "server_3 /api/agents/followup-email",
            "when": "Hourly Gmail scan. Day 7/14/21 email sends only between 9 AM and 11 AM IST.",
            "payload": []
        },
        "agent_14_linkedin_outreach": {
            "type": "scheduled_window",
            "window": "9 AM to 6 PM IST",
            "target": "server_3 /api/agents/linkedin-outreach",
            "when": "2 days after application submitted. Only within operating window.",
            "payload": []
        },
        "agent_15_calibration_layer2": {
            "type": "pg_cron_http",
            "schedule": "30 23 * * *",
            "schedule_ist": "5:00 AM IST daily",
            "target": "server_3 /api/agents/calibrate/daily",
            "payload": []
        },
        "agent_15_calibration_layer3": {
            "type": "pg_cron_http",
            "schedule": "45 18 * * 6",
            "schedule_ist": "12:15 AM IST Sunday",
            "target": "server_3 /api/agents/calibrate/weekly",
            "when": "Requires >= 50 outcome signals in past 7 days. Skip if fewer.",
            "payload": []
        }
    }
}